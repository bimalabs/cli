version: '3'
tasks:
    build:
        cmds:
            - docker build -t ad3n/bima-cli:latest .
            - docker-slim build --target ad3n/bima-cli:latest --tag ad3n/bima-cli:slim --http-probe=false
    install:
        cmds:
            - go build -o bima
            - mv bima $GOPATH/bin/bima
    commit:
        cmds:
            - git commit -am "{{.CLI_ARGS}}"
            - git push
    release:
        cmds:
            - git tag -a {{.CLI_ARGS}} -m "release {{.CLI_ARGS}}"
            - git push origin {{.CLI_ARGS}}
